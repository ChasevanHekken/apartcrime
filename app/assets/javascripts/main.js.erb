var map, pointarray, heatmap;
var markers = [];

var crime_heat = gon.crimes

for (var i = 0; i < crime_heat.length; i++) {
  console.log(crime_heat[i][0], crime_heat[i][1]);
}

var heatmapData = [];

for (var i = 0; i < crime_heat.length; i++) {
  var coord = crime_heat[i];
  if(coord[0] != null) {
    var latLng = new google.maps.LatLng(coord[0], coord[1]);
    heatmapData.push(latLng);
  }
}

// var crime_points = [[40.0522357, -75.15145178], [40.03302435, -75.17768064], [39.9974267, -75.16853513], [39.9974267, -75.16853513], [39.92070288, -75.15840949], [39.91466559, -75.16550747], [39.99769971, -75.17666012], [39.93266529, -75.17290807], [39.98780861, -75.09219411], [39.9878208, -75.09197319], [40.05112281, -75.15696127], [39.95421282, -75.20657192], [40.12900419, -75.01386929], [40.07229575, -75.24311512], [40.10006741, -75.01004609], [39.95063167, -75.20247352], [39.95063167, -75.20247352], [39.92368494, -75.15808001], [40.10857628, -75.02912259], [40.06511283, -75.06258323], [39.94668508, -75.16266924], [39.98763245, -75.12406548], [39.99517568, -75.09904557], [39.97131238, -75.12713853], [39.94646914, -75.16091996], [39.97586934, -75.12254435], [39.9828635, -75.12541849], [39.97175067, -75.16125157], [39.95083253, -75.21099472], [40.03796812, -75.03577821], [39.93388709, -75.21898927], [40.041686999999996, -75.04940309]]
// var crime_points = gon.crimes
var marker, i;

function initialize() {
  var mapOptions = {
    center: new google.maps.LatLng(39.9500, -75.1667),
    zoom: 12
  };

  map = new google.maps.Map(document.getElementById('map-canvas'),
    mapOptions);

  heatmap = new google.maps.visualization.HeatmapLayer({
    data: heatmapData
  });

  heatmap.setMap(map);

  // for (i = 0; i < crime_points.length; i++) {
  //     marker = new google.maps.Marker({
  //       position: { lat: crime_points[i][0], lng: crime_points[i][1]} ,
  //       map: map
  //     });
  //     markers.push(marker);
  // };

}

function toggleHeatmap() {
  heatmap.setMap(heatmap.getMap() ? null : map);
}
// Sets the map on all markers in the array.
function setAllMap(map) {
  for (var i = 0; i < markers.length; i++) {
    markers[i].setMap(map);
  }
}
// Removes the markers from the map, but keeps them in the array.
function clearMarkers() {
  setAllMap(null);
}
// Shows any markers currently in the array.
function showMarkers() {
  setAllMap(map);
}

var dataPointsHidden = false

function toggleDatapoints() {
  if (dataPointsHidden === true) {
    clearMarkers();
  } else {
    showMarkers();
  }
  dataPointsHidden = !dataPointsHidden;
}

google.maps.event.addDomListener(window, 'load', initialize);

