var map, pointarray, heatmap;
var markers = [];

var crime_heat = gon.homicide;
var rape = gon.rape;
var robbery = gon.robbery;
var assault = gon.assault;
var burglary = gon.burglary;
var theft = gon.theft;
var gta = gon.gta;

var apart_points = gon.marker_points;

var heatmapData = [];

for (var i = 0; i < crime_heat.length; i++) {
  if(crime_heat[i][0] != null) {
    var latLng = new google.maps.LatLng(crime_heat[i][0], crime_heat[i][1]);
    heatmapData.push(latLng);
  }
}

var marker, i, infowindow, content;

function initialize() {
  var mapOptions = {
    center: new google.maps.LatLng(39.9500, -75.1667),
    zoom: 12
  };

  map = new google.maps.Map(document.getElementById('map-canvas'),
    mapOptions);

  heatmap = new google.maps.visualization.HeatmapLayer({
    data: heatmapData
  });

  heatmap.setMap(map);

  for (i = 0; i < apart_points.length; i++) {
    if(apart_points[i][0] != null) {
      marker = new google.maps.Marker({
        position: { lat: apart_points[i][0], lng: apart_points[i][1]} ,
        map: map,
        title: apart_points[i][3]
      });
      markers.push(marker);

      infowindow = new google.maps.InfoWindow({
        content: apart_points[i][2]
      });

      content = apart_points[i][2];

      google.maps.event.addListener(marker, 'click', (function(marker,content,infowindow){
        return function() {
          infowindow.setContent(content);
          infowindow.open(map,marker);
          setTimeout(function () { infowindow.close(); }, 6000);
        };
      })(marker,content,infowindow));
    }
  };
}

google.maps.event.addDomListener(window, 'load', initialize);

function toggleHeatmap() {
  heatmap.setMap(heatmap.getMap() ? null : map);
}
// Sets the map on all markers in the array.
function setAllMap(map) {
  for (var i = 0; i < markers.length; i++) {
    markers[i].setMap(map);
  }
}
// Removes the markers from the map, but keeps them in the array.
function clearMarkers() {
  setAllMap(null);
}
// Shows any markers currently in the array.
function showMarkers() {
  setAllMap(map);
}

var dataPointsHidden = false

function toggleDatapoints() {
  if (dataPointsHidden == true) {
    clearMarkers();
  } else {
    showMarkers();
  }
  dataPointsHidden = !dataPointsHidden;
}

function toggleRape() {

}






// 100	Homicide
// 200	Rape
// 300	Robbery (with Firearm or not)
// 400	Agggravated Assault (with Firearm or not)
// 500	Burglary (Residential or Non-Residential)
// 600	Theft (from Vehicle or not)
// 700	Motor Vehicle Theft and Recovered Stolen Motor Vehicle



















// 100	Homicide
// 200	Rape
// 300	Robbery (with Firearm or not)
// 400	Agggravated Assault (with Firearm or not)
// 500	Burglary (Residential or Non-Residential)
// 600	Theft (from Vehicle or not)
// 700	Motor Vehicle Theft and Recovered Stolen Motor Vehicle
